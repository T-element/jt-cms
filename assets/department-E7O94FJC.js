import{u as C,a as f,b as y,_ as l,c as d}from"./useDialog-HvsZYfJM.js";import{_ as s}from"./pageContent-yQ-Ny5CZ.js";import{j as o,_,Z as D,c as k,o as b,b as r,w as P,k as w,B}from"./index-DUPduILs.js";/* empty css             *//* empty css                  *//* empty css                   *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css               *//* empty css                 */function I(e){return o.get({url:`/department/${e}`})}function O(e){return o.post({url:"/department",data:{...e}})}function L(e){const{id:n,name:a,leader:i,parentId:t}=e;return o.patch({url:`/department/${n}`,data:{name:a,leader:i,parentId:t}})}function A(e){return o.delete({url:`/department/${e}`})}const E=[{name:"部门名称",placeholder:"请输入部门名称",key:"name",type:"input"},{name:"部门领导",placeholder:"请输入部门领导",key:"leader",type:"input"},{name:"创建时间",type:"datePicker",key:"createAt"}],H={header:{title:"部门列表",btnName:"新建部门"},content:{tableOption:[{type:"selection",width:"55"},{type:"index",label:"序号",width:"70"},{prop:"name",label:"部门名称",width:"120"},{prop:"leader",label:"部门领导",width:"120"},{prop:"parentId",label:"上级部门",width:"100",type:"custom",slotName:"leader"},{prop:"createAt",label:"创建时间",minWidth:"120",type:"createDate"},{prop:"updateAt",label:"更新时间",minWidth:"120",type:"updateDate"},{label:"操作",width:"170",type:"operation"}]}},M={title:"新建部门",formOption:[{type:"label",label:"部门名称",placeholder:"请输入部门名称",key:"name"},{type:"select",label:"上级部门",placeholder:"请选择上级部门",key:"parentId",selectOptions:[]},{type:"label",label:"领导名称",placeholder:"请输入领导名称",key:"leader"}]},p={listPath:"system/fetchDepartmentList",createFn:O,editFn:L,deleteFn:A},N=C(p),q=f(p),v=y(p),F={components:{PageHeader:d,PageContent:s,PageDialog:l},data(){return{headerOption:E,headerData:{name:"",leader:"",createAt:""},contentOption:H,dialogOption:M,dialogData:{name:"",parentId:"",leader:""},requestConfig:{offset:0,size:10},parentDpm:new Map}},computed:{...D("system",{departmentList:e=>e.departmentList,departmentTotalCount:e=>e.departmentTotalCount})},mixins:[N,q,v],methods:{mapDepartmentByParentId(e){if(e==null)return;const n=this.parentDpm.get(e);return n||(this.parentDpm.set(e,"/"),I(e).then(a=>{this.parentDpm.set(e,a.data.data.name)})),n}},created(){this.$store.dispatch("system/fetchDepartmentList",this.requestConfig).then(()=>{this.setupDialogSelectOption(this.departmentList,"上级部门")})}},Q={class:"department"};function S(e,n,a,i,t,c){const m=d,u=s,h=l;return b(),k("div",Q,[r(m,{option:t.headerOption,data:t.headerData,onQueryBtnClick:e.handleQueryClick},null,8,["option","data","onQueryBtnClick"]),r(u,{option:t.contentOption,data:e.departmentList,"total-count":e.departmentTotalCount,onPagerChange:e.handlePagerChange,onCreateClick:e.handleCreate,onDeleteClick:e.handleDelete,onEditClick:e.handleEdit},{leader:P(g=>[w("span",null,B(c.mapDepartmentByParentId(g.data.parentId)),1)]),_:1},8,["option","data","total-count","onPagerChange","onCreateClick","onDeleteClick","onEditClick"]),r(h,{ref:"dialogRef",option:t.dialogOption,onConfirmClick:e.handleConfirmClick},null,8,["option","onConfirmClick"])])}const K=_(F,[["render",S],["__scopeId","data-v-fe30757b"]]);export{K as default};
