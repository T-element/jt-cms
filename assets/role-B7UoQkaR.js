import{u as y,a as C,b as g,_ as l,c as r}from"./useDialog-DSzFy35W.js";/* empty css             *//* empty css                 */import{_ as c}from"./pageContent-DG5unNTM.js";import{_,Z as k,c as b,o as L,b as i,w,ae as P,af as R,ag as p,ah as d,t as D,ai as M}from"./index-Ds9wwjLc.js";/* empty css                 *//* empty css                   *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css               */const T=[{name:"角色名称",placeholder:"请输入角色名称",key:"name",type:"input"},{name:"权限介绍",placeholder:"请输入权限介绍",key:"intro",type:"input"},{name:"创建时间",type:"datePicker",key:"createAt"}],O={header:{title:"角色列表",btnName:"新建角色"},content:{tableOption:[{type:"selection",width:"55"},{type:"index",label:"序号",width:"70"},{prop:"name",label:"用户名",width:"120"},{prop:"intro",label:"角色权限",width:"120"},{prop:"createAt",label:"创建时间",minWidth:"120",type:"createDate"},{prop:"updateAt",label:"更新时间",minWidth:"120",type:"updateDate"},{label:"操作",width:"170",type:"operation"}]}},E={title:"新建用户",formOption:[{type:"label",label:"角色名称",placeholder:"请输入角色名称",key:"name"},{type:"label",label:"角色描述",placeholder:"请输入角色描述",key:"intro"},{type:"custom",key:"menuList",slotName:"menuList"}]},s={listPath:"system/fetchRoleList",createFn:p,editFn:d,deleteFn:M},I=y(s),A=C(s),q=g(s),x={components:{PageHeader:r,PageContent:c,PageDialog:l},mixins:[I,A,q],data(){return{headerOption:T,headerData:{name:"",intro:"",createAt:""},contentOption:O,dialogOption:E,requestConfig:{offset:0,size:10},elTreeProps:{label:"name",children:"children"}}},computed:{...k("system",{roleList:e=>e.roleList,roleTotalCount:e=>e.roleTotalCount,menuList:e=>e.menuList})},methods:{async handleConfirmClick(e,o){e.menuList=this.$refs.elTreeRef.getCheckedKeys(!1),console.log(e);let t;o==="create"?(t=await p(e),this.$store.dispatch("system/fetchRoleList",this.requestConfig)):o==="edit"&&(t=await d(e),this.$store.dispatch("system/fetchRoleList",this.requestConfig)),D({message:t.data.data,type:t.data.code===0?"success":"error"})},async handleEdit(e){console.log(e),this.$refs.dialogRef.setFormState(e,"edit");const o=await R(e.id);this.$refs.elTreeRef.setCheckedKeys(o.data.data.menuIds)},formatMenuItem(e){if(e==null||typeof e!="object")return e;let o;if(Array.isArray(e)){o=[];for(let t in e)o[t]=this.formatMenuItem(e[t]);return o}else{o={};for(let t in e)t==="name"?o.label=e[t]:t==="children"&&(o[t]=this.formatMenuItem(e[t]));return o}}},created(){this.$store.dispatch("system/fetchRoleList",this.requestConfig),this.$store.dispatch("system/fetchMenuList",this.requestConfig)}},B={class:"role"};function F(e,o,t,H,n,a){const m=r,h=c,u=P,f=l;return L(),b("div",B,[i(m,{option:n.headerOption,data:n.headerData,onQueryBtnClick:e.handleQueryClick},null,8,["option","data","onQueryBtnClick"]),i(h,{option:n.contentOption,data:e.roleList,"total-count":e.roleTotalCount,onPagerChange:e.handlePagerChange,onCreateClick:e.handleCreate,onDeleteClick:e.handleDelete,onEditClick:a.handleEdit},null,8,["option","data","total-count","onPagerChange","onCreateClick","onDeleteClick","onEditClick"]),i(f,{ref:"dialogRef",option:n.dialogOption,onConfirmClick:a.handleConfirmClick},{menuList:w($=>[i(u,{ref:"elTreeRef",style:{"max-width":"600px"},data:e.menuList,props:n.elTreeProps,"node-key":"id","show-checkbox":""},null,8,["data","props"])]),_:1},8,["option","onConfirmClick"])])}const J=_(x,[["render",F],["__scopeId","data-v-639ef279"]]);export{J as default};
