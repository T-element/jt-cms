import{u as C,a as g,b as _,_ as l,c as r}from"./useDialog-b0DF0rol.js";/* empty css             *//* empty css                 */import{_ as c}from"./pageContent-CbkfwtLN.js";import{j as p,_ as k,Z as b,c as L,o as R,b as i,w,ah as P,ai as D,aj as d,t as M}from"./index-DYtJqOqJ.js";/* empty css                 *//* empty css                   *//* empty css                  *//* empty css               *//* empty css                     *//* empty css                  *//* empty css               */function T(e){return p.delete({url:`/role/${e}`})}function m(e){return p.post({url:"/role",data:{...e}})}const O=[{name:"角色名称",placeholder:"请输入角色名称",key:"name",type:"input"},{name:"权限介绍",placeholder:"请输入权限介绍",key:"intro",type:"input"},{name:"创建时间",type:"datePicker",key:"createAt"}],E={header:{title:"角色列表",btnName:"新建角色"},content:{tableOption:[{type:"selection",width:"55"},{type:"index",label:"序号",width:"70"},{prop:"name",label:"用户名",width:"120"},{prop:"intro",label:"角色权限",width:"120"},{prop:"createAt",label:"创建时间",minWidth:"120",type:"createDate"},{prop:"updateAt",label:"更新时间",minWidth:"120",type:"updateDate"},{label:"操作",width:"170",type:"operation"}]}},I={title:"新建用户",formOption:[{type:"label",label:"角色名称",placeholder:"请输入角色名称",key:"name"},{type:"label",label:"角色描述",placeholder:"请输入角色描述",key:"intro"},{type:"custom",key:"menuList",slotName:"menuList"}]},s={listPath:"system/fetchRoleList",createFn:m,editFn:d,deleteFn:T},q=C(s),A=g(s),x=_(s),B={components:{PageHeader:r,PageContent:c,PageDialog:l},mixins:[q,A,x],data(){return{headerOption:O,headerData:{name:"",intro:"",createAt:""},contentOption:E,dialogOption:I,requestConfig:{offset:0,size:10},elTreeProps:{label:"name",children:"children"}}},computed:{...b("system",{roleList:e=>e.roleList,roleTotalCount:e=>e.roleTotalCount,menuList:e=>e.menuList})},methods:{async handleConfirmClick(e,o){e.menuList=this.$refs.elTreeRef.getCheckedKeys(!1),console.log(e);let t;o==="create"?(t=await m(e),this.$store.dispatch("system/fetchRoleList",this.requestConfig)):o==="edit"&&(t=await d(e),this.$store.dispatch("system/fetchRoleList",this.requestConfig)),M({message:t.data.data,type:t.data.code===0?"success":"error"})},async handleEdit(e){console.log(e),this.$refs.dialogRef.setFormState(e,"edit");const o=await D(e.id);this.$refs.elTreeRef.setCheckedKeys(o.data.data.menuIds)},formatMenuItem(e){if(e==null||typeof e!="object")return e;let o;if(Array.isArray(e)){o=[];for(let t in e)o[t]=this.formatMenuItem(e[t]);return o}else{o={};for(let t in e)t==="name"?o.label=e[t]:t==="children"&&(o[t]=this.formatMenuItem(e[t]));return o}}},created(){this.$store.dispatch("system/fetchRoleList",this.requestConfig),this.$store.dispatch("system/fetchMenuList",this.requestConfig)}},$={class:"role"};function j(e,o,t,F,n,a){const h=r,u=c,f=P,y=l;return R(),L("div",$,[i(h,{option:n.headerOption,data:n.headerData,onQueryBtnClick:e.handleQueryClick},null,8,["option","data","onQueryBtnClick"]),i(u,{option:n.contentOption,data:e.roleList,"total-count":e.roleTotalCount,onPagerChange:e.handlePagerChange,onCreateClick:e.handleCreate,onDeleteClick:e.handleDelete,onEditClick:a.handleEdit},null,8,["option","data","total-count","onPagerChange","onCreateClick","onDeleteClick","onEditClick"]),i(y,{ref:"dialogRef",option:n.dialogOption,onConfirmClick:a.handleConfirmClick},{menuList:w(H=>[i(f,{ref:"elTreeRef",style:{"max-width":"600px"},data:e.menuList,props:n.elTreeProps,"node-key":"id","show-checkbox":""},null,8,["data","props"])]),_:1},8,["option","onConfirmClick"])])}const X=k(B,[["render",j],["__scopeId","data-v-639ef279"]]);export{X as default};
